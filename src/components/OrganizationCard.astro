---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";
import type { OrganizationCard } from "../lib/notion-interfaces";
import { getOrganizationPhotoPath } from "../lib/blog-helpers";

interface Props {
  item: OrganizationCard;
  showDescription?: boolean;
  sizeImage?: number;
}

const { item, showDescription = true, sizeImage = 120 } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>(
  "/src/assets/notion/**/*.{jpeg,jpg,png,tiff,webp,gif,svg,avif}"
);

const imagePath = getOrganizationPhotoPath(item);
const imageSrc = images[imagePath] ? images[imagePath]() : null;

const name = item.Name;
const description = item.Description;
const linkedin = item.LinkedIn;
const website = item.Website;
const linkTarget = website || linkedin || "#";
---

<a
  href={linkTarget}
  target="_blank"
  rel="noopener noreferrer"
  aria-label={"Visit " + name}
  class="transition- flex w-full max-w-sm transform flex-col items-center justify-between rounded-xl bg-[var(--background-cards)] p-6 shadow-md duration-300 hover:shadow-lg hover:brightness-105 sm:items-start"
>
  {
    imageSrc ? (
      <Image
        src={imageSrc}
        alt={`${name} logo`}
        class="mb-4 h-auto w-full max-w-[${sizeImage}px] object-contain"
      />
    ) : (
      <div class="mb-4 flex h-[${sizeImage}px] w-[${sizeImage}px] items-center justify-center rounded-full bg-gray-200 text-sm text-gray-500">
        No Image
      </div>
    )
  }
</a>
