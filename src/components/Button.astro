---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
  text: string;
  link: string;
  downloadName?: string;
  openOnNewTab?: boolean;
  flex?: boolean;
  icon?: "download" | "redirect";
}

const { text, link, downloadName, openOnNewTab, flex, icon } = Astro.props;

var target = "_self";
if (openOnNewTab) {
  var target = "_blank";
}

var iconPath = "";
if (icon === "download") {
  var iconPath = "/src/assets/download.svg";
} else if (icon === "redirect") {
  var iconPath = "/src/assets/redirect.svg";
}

const images = import.meta.glob<{ default: ImageMetadata }>("/src/assets/*.{jpeg,jpg,png,gif,svg}");
if (icon != undefined) {
  if (!images[iconPath]) throw new Error(`"${iconPath}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif,svg}"`);
}
---

<a
  href={link}
  download={downloadName}
  target={target}>
  <button class:list={[{ flex: flex }]}
    >{
      icon != undefined && (
        <Image
          src={images[iconPath]()}
          alt="icon"
        />
      )
    }{text}</button
  >
</a>
<style>
  a {
    display: flex;
    text-decoration: none;
  }

  .flex {
    flex: 1;
  }

  button {
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-family-primary);
    font-size: 1rem;
    border-radius: 0.3rem;
    border: none;
    padding: 0.2rem 0.8rem;
    color: var(--background-body)
  }

  img {
    margin-right: 0.5rem;
    height: 40%;
  }

  button:hover {
    background-color: var(--background-body);
    color: var(--text-main);
    cursor: pointer;
  }
</style>
